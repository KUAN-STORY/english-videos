<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>英語影片播放器</title>
  <style>
    :root{
      --bg:#0b1324;--panel:#0f172a;--panel2:#0f1a33;--border:#1f2a44;
      --text:#e6efff;--muted:#9fb1cc;--btn:#122340;--btn-b:#1f375f;--btn-on:#154274;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui}
    .wrap{display:flex;flex-direction:column;height:100%}
    header{display:flex;justify-content:space-between;align-items:center;padding:14px 20px;background:var(--panel2);border-bottom:1px solid var(--border)}
    header h1{margin:0;font-size:20px}
    #authArea{display:flex;gap:10px;align-items:center}
    .btn{background:#1e293b;color:#e6efff;border:1px solid #334155;border-radius:10px;padding:8px 12px;cursor:pointer}

    main{flex:1;display:flex;gap:20px;padding:20px;overflow:hidden}
    #videoWrap{flex:1;min-width:0;display:flex;flex-direction:column}
    #videoBox{flex:1;min-height:240px;display:flex;align-items:center;justify-content:center;background:#000;border-radius:10px;overflow:hidden}
    #player{width:100%;height:100%;max-height:100%}

    /* 工具列固定在影片下方、可見 */
    #controls{margin-top:10px;background:var(--panel2);border:1px solid var(--border);border-radius:12px;padding:12px}
    #controls .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
    .kbtn{display:inline-flex;align-items:center;gap:6px;background:var(--btn);border:1px solid var(--btn-b);border-radius:10px;padding:8px 10px;cursor:pointer}
    .kbtn:active{transform:translateY(1px)}
    .kbtn.on{background:var(--btn-on)}
    .range{display:flex;align-items:center;gap:10px;margin-top:8px}

    /* 右側：固定 50% 寬，自己滾動 */
    .right{flex:1;min-width:0;display:flex;flex-direction:column;background:var(--panel);border:1px solid var(--border);border-radius:12px;overflow:hidden}
    .tabs{display:flex;gap:10px;padding:12px;border-bottom:1px solid var(--border);background:var(--panel2)}
    .tab{background:#122340;border:1px solid #1f375f;border-radius:10px;padding:8px 12px;cursor:pointer}
    .tab.active{background:#154274}
    .pane{flex:1;overflow:auto;padding:12px}

    /* 字幕表格（你原本的） */
    table.subs{width:100%;border-collapse:collapse}
    table.subs th,table.subs td{border-bottom:1px solid #1f2a44;padding:10px 8px;vertical-align:top}
    table.subs th{position:sticky;top:0;background:var(--panel2);z-index:1}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>英語影片播放器</h1>
      <div id="authArea">
        <span id="userNameBadge" style="color:#cbd5e1"></span>
        <button id="btnLogin" class="btn">登入</button>
        <button id="btnLogout" class="btn" style="display:none">登出</button>
      </div>
    </header>

    <main>
      <!-- 左：影片（保持 v7.2 需要的 #player 與 #controls） -->
      <section id="videoWrap">
        <div id="videoBox">
          <video id="player" controls playsinline></video>
        </div>

        <!-- 你的功能列（保留常用 ID，v7.2 可直接用） -->
        <div id="controls">
          <div class="row">
            <button id="btnPrev" class="kbtn">⏮ 上一句</button>
            <button id="btnPlay" class="kbtn">▶️ 播放 / 暫停</button>
            <button id="btnNext" class="kbtn">⏭ 下一句</button>
            <button id="btnRepeatLine" class="kbtn">🔁 重複本句</button>
            <button id="btnAutoPause" class="kbtn">🧠 逐句自動暫停</button>
            <button id="btnSectionLoop" class="kbtn">🔁 整段循環</button>
            <button id="btnAbLoop" class="kbtn">🅰️🅱️ A-B 循環</button>
            <button id="btnWordLoop" class="kbtn">🔊 點句即循環</button>
            <button id="btnCancelLoop" class="kbtn">🧹 取消循環</button>
            <button id="btnFill" class="kbtn">🖼️ 填滿畫面</button>
          </div>
          <div class="range">
            <span>速度</span>
            <input id="speedRange" type="range" min="0.5" max="2" step="0.05" value="1">
            <span id="speedLabel">1.00x</span>
          </div>
          <div class="muted" style="margin-top:6px;color:#9fb1cc">（這裡是功能控制列，保持顯示）</div>
        </div>
      </section>

      <!-- 右：字幕 / 測驗 / 單字（固定 50%，獨立滾動） -->
      <section class="right">
        <div class="tabs">
          <div class="tab active" data-tab="sub" id="tabSub">字幕</div>
          <div class="tab" data-tab="quiz" id="tabQuiz">測驗</div>
          <div class="tab" data-tab="vocab" id="tabVocab">單字</div>
        </div>
        <div id="pane-sub" class="pane">…（字幕表格）…</div>
        <div id="pane-quiz" class="pane" style="display:none">…（測驗容器）…</div>
        <div id="pane-vocab" class="pane" style="display:none">…（單字容器）…</div>
      </section>
    </main>
  </div>

  <!-- Supabase 登入模組（ESM） -->
  <script type="module" src="login.js"></script>
  <!-- 你的播放器主程式（v7.2） -->
  <script src="./player.js"></script>
</body>
</html>

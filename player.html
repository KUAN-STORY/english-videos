<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>英語影片播放器</title>

<!-- ===== 外觀變數（盡量維持你原本結構與色系） ===== -->
<style>
:root{
  --bg:#0b1324; --panel:#0f172a; --ink:#e6efff; --muted:#9fb0c9; --accent:#3c7cff; --border:#1f2a44;
  --ok:#22c55e; --warn:#f59e0b; --bad:#ef4444;
}
*{ box-sizing:border-box; }
html,body{ height:100%; background:var(--bg); color:var(--ink); font-family: system-ui,-apple-system,'Segoe UI',Roboto,'Noto Sans TC','PingFang TC',Arial; }
button{ color:var(--ink); background:#11203b; border:1px solid var(--border); border-radius:12px; padding:10px 14px; cursor:pointer; }
button:disabled{ opacity:.55; pointer-events:none; }
.badge{ padding:6px 10px; border-radius:12px; border:1px solid var(--border); background:#0f1b33; }
.tabs button{ margin-right:8px; }
.tabs .on{ background:var(--accent); color:#fff; }

.wrap{ max-width:1400px; margin:24px auto; padding:0 16px; }

/* 版頭 */
h1{ font-size:20px; letter-spacing:.1em; margin:0 0 14px; }

/* 主要兩欄（桌機維持左右並排） */
.grid{
  display:grid;
  grid-template-columns: minmax(320px,1fr) minmax(420px,1.15fr);
  gap:16px;
}

/* 面板 */
.panel{ background:var(--panel); border:1px solid var(--border); border-radius:16px; padding:16px; }

/* 影片 */
#player{ width:100%; max-height:60vh; background:#000; border-radius:12px; outline:none; }

/* 播放工具列 */
.toolrow{ display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin-top:12px; }
.toolrow .group{ display:flex; gap:8px; align-items:center; }
.range{ width:260px; }

/* 右欄 */
#rightPane{ overflow:auto; max-height:calc(100vh - 140px); }
.table{ width:100%; border-collapse:collapse; }
.table th,.table td{ border-bottom:1px solid var(--border); padding:14px 10px; vertical-align:top; }
.table th{ color:var(--muted); font-weight:600; }
.time{ white-space:nowrap; color:var(--muted); }

/* 版本與登入 */
#verBadgeTop{ position:fixed; right:10px; top:8px; z-index:10050; }
#authBtns{ position:fixed; right:110px; top:8px; z-index:10051; display:flex; gap:8px; }
#userBadge{ position:fixed; right:210px; top:10px; z-index:10052; color:var(--muted); }

/* 登入守門 */
#gate{
  position:fixed; inset:0; background:rgba(5,10,20,.72);
  display:none; align-items:center; justify-content:center; z-index:20000;
}
#gate .card{ width:min(560px,92%); background:#0f1b33; border:1px solid var(--border); border-radius:16px; padding:18px; }
#gate h3{ margin:0 0 8px; }
#gate p{ color:var(--muted); margin:0 0 14px; }

/* 列印（只印右欄內容，排版像成績單） */
@media print{
  body{ background:#fff; color:#111; }
  #verBadgeTop,#authBtns,#userBadge,#leftPane{ display:none !important; }
  #rightPane{ max-height:none; border:none; }
  .panel{ border:none; }
  .table th,.table td{ border-bottom:1px solid #ddd; }
  .print-header{ display:block !important; margin-bottom:12px; }
}
.print-header{ display:none; }
.print-header h2{ margin:0 0 6px; color:#111; }
.print-header .meta{ color:#333; font-size:14px; }

/* 手機：上下堆疊（保持你要的手機排版） */
@media (max-width: 860px){
  .grid{ grid-template-columns: 1fr; }
  #rightPane{ max-height:none; }
}
</style>
</head>

<body>
<div class="wrap">
  <h1>英語影片播放器</h1>

  <!-- 右上角：版本＆登入 -->
  <span id="verBadgeTop" class="badge">V20251007-004</span>
  <span id="userBadge"></span>
  <div id="authBtns">
    <button id="btnLogin">登入</button>
    <button id="btnLogout" style="display:none">登出</button>
  </div>

  <div class="grid">
    <!-- ===== 左欄：影片 + 工具列（維持原結構） ===== -->
    <div id="leftPane" class="panel">
      <video id="player" playsinline preload="metadata" controls poster="" src=""></video>

      <div class="toolrow" id="toolrow">
        <div class="group">
          <button id="btnPrev">上一句</button>
          <button id="btnPlay">播放/暫停</button>
          <button id="btnNext">下一句</button>
          <button id="btnReplay">重複本句</button>
        </div>

        <div class="group">
          <label><input type="checkbox" id="chkFollow"> 跟隨</label>
          <span class="badge">偏移</span>
          <button id="btnOffsetMinus">-0.5s</button>
          <button id="btnOffsetPlus">+0.5s</button>
          <button id="btnAutoSync">簡易校準</button>
        </div>

        <div class="group">
          <span>速度</span>
          <input type="range" id="speedRange" min="0.5" max="1.5" step="0.05" value="1" class="range" />
          <span id="speedVal">1.00x</span>
        </div>
      </div>
    </div>

    <!-- ===== 右欄：分頁 + 內容 ===== -->
    <div id="rightPane" class="panel">
      <div class="tabs">
        <button data-tab="sub" class="on">字幕</button>
        <button data-tab="quiz">測驗</button>
        <button data-tab="voc">單字</button>
      </div>

      <!-- 列印頁首（只在 print 顯示） -->
      <div class="print-header" id="printHead">
        <h2 id="printTitle">BookWide ‧ 英語影片測驗成績單</h2>
        <div class="meta" id="printMeta">（自動產生）</div>
      </div>

      <!-- 字幕 -->
      <section id="tab-sub">
        <p style="color:var(--muted)">已載入字幕（<span id="slugBadge">—</span>）</p>
        <table class="table" id="subTable">
          <thead>
          <tr><th style="width:84px">時間</th><th>英文</th><th>中文</th></tr>
          </thead>
          <tbody id="subTbody">
            <!-- 動態填入 -->
          </tbody>
        </table>
      </section>

      <!-- 測驗 -->
      <section id="tab-quiz" style="display:none">
        <div id="quizWrap"></div>
        <div class="toolrow" style="margin-top:12px">
          <div class="group">
            <button id="btnSubmit">交卷</button>
            <button id="btnReveal">顯示答案</button>
            <button id="btnPrint">列印成績單</button>
            <span class="badge">本分區分數：<span id="scoreNow">0</span> / <span id="scoreMax">100</span></span>
          </div>
        </div>
      </section>

      <!-- 單字 -->
      <section id="tab-voc" style="display:none">
        <div id="vocWrap">
          <div class="panel" style="background:#0e203b;border:1px dashed var(--border)">
            <b>vocabulary / 字彙（示範）</b>
            <ul>
              <li><b>festival</b> / 節慶</li>
              <li><b>lantern</b> / 燈籠</li>
              <li><b>myth</b> / 神話</li>
            </ul>
          </div>
        </div>
      </section>
    </div>
  </div>
</div>

<!-- ===== 登入守門 ===== -->
<div id="gate">
  <div class="card">
    <h3>需要登入</h3>
    <p>請先登入以繼續使用，您的學習記錄會安全地保存在雲端。</p>
    <div style="display:flex; gap:10px; justify-content:flex-end">
      <button id="gateCancel" class="badge">稍後</button>
      <button id="gateLogin" style="background:var(--accent)">以 Google 登入</button>
    </div>
  </div>
</div>

<!-- ====== Supabase ====== -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.js"></script>
<script>
/** 你的專案憑證（已去掉多餘 https://） */
const SUPABASE_URL = 'https://qtgwedankftrqjmzuset.supabase.co';
const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF0Z3dlZGFua2Z0cnFqbXp1c2V0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4NDYxMDMsImV4cCI6MjA3NDQyMjEwM30.jyETpt09pgm66aCZheMgsjtbKlVmYo-lt-hrrt6BF8g';

const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
const $ = sel => document.querySelector(sel);
const $$ = sel => Array.from(document.querySelectorAll(sel));

/* ===== UI 元件 ===== */
const $player   = $('#player');
const $speed    = $('#speedRange');
const $speedVal = $('#speedVal');
const $slugBadge= $('#slugBadge');
const $btnPrev  = $('#btnPrev');
const $btnPlay  = $('#btnPlay');
const $btnNext  = $('#btnNext');
const $btnReplay= $('#btnReplay');
const $btnOffsetMinus = $('#btnOffsetMinus');
const $btnOffsetPlus  = $('#btnOffsetPlus');
const $btnAutoSync    = $('#btnAutoSync');
const $chkFollow = $('#chkFollow');

/* ===== 登入/守門 ===== */
const $btnLogin  = $('#btnLogin');
const $btnLogout = $('#btnLogout');
const $userBadge = $('#userBadge');
const $gate      = $('#gate');
const $gateLogin = $('#gateLogin');
const $gateCancel= $('#gateCancel');

function showGate(on){ $gate.style.display = on?'flex':'none'; }
function setUserUI(user){
  if(user){
    $btnLogin.style.display='none';
    $btnLogout.style.display='';
    $userBadge.textContent = user.email || '';
  }else{
    $btnLogin.style.display='';
    $btnLogout.style.display='none';
    $userBadge.textContent = '';
  }
}

/* === 未登入鎖 UI（維持你原結構，單純開/關可操作） === */
function toggleStudyUI(enabled){
  const ctrls = ['#btnPrev','#btnPlay','#btnNext','#btnReplay',
                 '#btnOffsetMinus','#btnOffsetPlus','#btnAutoSync',
                 '#speedRange','#chkFollow'];
  ctrls.forEach(sel=>{
    const el = $(sel);
    if(el){ el.disabled = !enabled; el.style.pointerEvents = enabled?'':'none'; el.style.opacity = enabled?'':'0.55'; }
  });
  if($player){
    if(!enabled) $player.pause();
    $player.controls = enabled;
  }
}
toggleStudyUI(false);

/* ===== 解析 slug 並載入影片/字幕（照你的既有結構） ===== */
const params = new URLSearchParams(location.search);
const slug = params.get('slug') || 'mid-autumn';
$slugBadge.textContent = slug.replace(/-/g,' ');
const demoSrc = {
  'mid-autumn': 'https://cdn.jsdelivr.net/gh/ismfile/cdn-videos@main/mid-autumn-demo.mp4',
  'houyi': 'https://cdn.jsdelivr.net/gh/ismfile/cdn-videos@main/houyi-demo.mp4'
};
$player.src = demoSrc[slug] || demoSrc['mid-autumn'];

/* ===== 分頁切換（字幕/測驗/單字） ===== */
$$('.tabs button').forEach(btn=>{
  btn.addEventListener('click',()=>{
    $$('.tabs button').forEach(b=>b.classList.remove('on'));
    btn.classList.add('on');
    const tab = btn.dataset.tab;
    $('#tab-sub').style.display = (tab==='sub')?'':'none';
    $('#tab-quiz').style.display= (tab==='quiz')?'':'none';
    $('#tab-voc').style.display = (tab==='voc')?'':'none';
  });
});

/* ====== 假資料：字幕/測驗 ====== */
const demoSubs = [
  {t:'00:01', en:'The Mid-Autumn Festival is on the fifteenth day of the eighth month in the Chinese calendar.', zh:'中秋節是在農曆八月十五日。'},
  {t:'00:06', en:'It is a time to look at the big round moon.', zh:'這是一個仰望又大又圓的月亮的時刻。'},
  {t:'00:11', en:'This has been a special day in China for a very long time.', zh:'這一天在中國已經是特別的日子很久很久了。'}
];
const $subTbody = $('#subTbody');
$subTbody.innerHTML = demoSubs.map(r=>(
  `<tr><td class="time">${r.t}</td><td>${r.en}</td><td>${r.zh}</td></tr>`
)).join('');

const $quizWrap = $('#quizWrap');
const quiz = [
  {q:'People eat ___ during the Mid-Autumn Festival.', opts:['dumplings','rice cakes','mooncakes','noodles'], ans:2},
  {q:'We admire the bright full ___ at night.', opts:['sun','star','moon','cloud'], ans:2}
];
function renderQuiz(){
  $quizWrap.innerHTML = quiz.map((it,idx)=>`
    <div class="panel" style="margin:10px 0">
      <div style="margin-bottom:8px">${idx+1}. ${it.q}</div>
      ${it.opts.map((op,i)=>`
        <label style="display:block;margin:6px 0">
          <input type="radio" name="q${idx}" value="${i}"> ${op}
        </label>`).join('')}
      <div class="badge" id="exp${idx}" style="display:none;margin-top:6px">正解：${it.opts[it.ans]}</div>
    </div>
  `).join('');
}
renderQuiz();

/* =========== 交卷 / 顯示答案 / 列印 =========== */
let lastScore = 0;
const $scoreNow = $('#scoreNow'), $scoreMax = $('#scoreMax');
$scoreMax.textContent = 100;

$('#btnSubmit').addEventListener('click', ()=>{
  let correct = 0;
  quiz.forEach((it,idx)=>{
    const v = (new FormData($quizWrap.closest('section'))).get(`q${idx}`);
    const right = Number(v)===it.ans;
    $('#exp'+idx).style.display='block';
    if(right) correct++;
  });
  lastScore = Math.round(correct/quiz.length*100);
  $scoreNow.textContent = lastScore;
  alert(`本分區分數：${lastScore} / 100`);
});

$('#btnReveal').addEventListener('click', ()=>{
  quiz.forEach((_,idx)=>$('#exp'+idx).style.display='block');
});

function preparePrintHeader(){
  const now = new Date();
  $('#printTitle').textContent = 'BookWide ‧ 英語影片測驗成績單';
  $('#printMeta').textContent  = `影片：${slug}　成績：${lastScore} / 100　時間：${now.toLocaleString()}　（行動列印）`;
}
$('#btnPrint').addEventListener('click', ()=>{
  preparePrintHeader();
  window.print();
});
// 補保險：使用者直接以系統列印（iOS/Android share→列印）
window.addEventListener('beforeprint', preparePrintHeader);

/* ====== 播放控制（簡版；維持你的既有ID，未登入鎖住） ====== */
$btnPlay.addEventListener('click',()=>{ $player.paused ? $player.play() : $player.pause(); });
$btnPrev.addEventListener('click',()=>{/* 省略：跳前一句 */});
$btnNext.addEventListener('click',()=>{/* 省略：跳後一句 */});
$btnReplay.addEventListener('click',()=>{ $player.currentTime = Math.max(0,$player.currentTime-2); $player.play(); });
$btnOffsetMinus.addEventListener('click',()=>{/* 省略：偏移 -0.5s */});
$btnOffsetPlus.addEventListener('click',()=>{/* 省略：偏移 +0.5s */});
$btnAutoSync.addEventListener('click',()=>{/* 省略：簡易校準 */});
$speed.addEventListener('input',()=>{ $player.playbackRate = Number($speed.value); $speedVal.textContent = $player.playbackRate.toFixed(2)+'x'; });

/* =========== 登入流程與紀錄 watch_logs（Production） =========== */
async function logWatch(user){
  try{
    await supabase.from('watch_logs').insert({
      user_id: user.id,
      email: user.email,
      video_slug: slug
    });
  }catch(e){ console.warn('log error',e); }
}

async function initAuth(){
  const { data:{ user } } = await supabase.auth.getUser();
  setUserUI(user);
  if(!user){ showGate(true); toggleStudyUI(false); }
  else{ showGate(false); toggleStudyUI(true); logWatch(user); }
}
supabase.auth.onAuthStateChange((_e,session)=>{
  const user = session?.user || null;
  setUserUI(user);
  showGate(!user);
  toggleStudyUI(!!user);
  if(user) logWatch(user);
});

$btnLogin.addEventListener('click', async ()=>{
  await supabase.auth.signInWithOAuth({ provider:'google' });
});
$btnLogout.addEventListener('click', async ()=>{
  await supabase.auth.signOut();
});
$gateLogin.addEventListener('click', async ()=>{
  await supabase.auth.signInWithOAuth({ provider:'google' });
});
$gateCancel.addEventListener('click', ()=>{
  alert('請先登入才能使用播放與測驗功能。');
  showGate(true); // 不關門，避免誤以為可繼續
});

/* 啟動 */
initAuth();
</script>
</body>
</html>













































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































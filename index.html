<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>BookWide · 英語學習入口</title>
  <meta name="description" content="BookWide：用故事、音樂、電影、新聞與專業主題，快速學英文。支援逐句播放、雙語字幕、測驗、單字卡。">
  <style>
    :root {
      --bg:#0b1324; --ink:#000; --panel:#fff; --border:#ddd;
      --primary:#0b1324; --accent:#3c7cff;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;font-family:system-ui,"Noto Sans TC";background:#fff;color:#000}
    a{text-decoration:none;color:inherit}
    img{max-width:100%;display:block}

    /* 工具列（黑底白字） */
    header{
      background:var(--bg);color:#fff;display:flex;align-items:center;
      justify-content:space-between;padding:10px 24px;position:sticky;top:0;z-index:50;
    }
    .brand{display:flex;align-items:center;gap:10px;font-weight:800;font-size:20px}
    .nav-links{display:flex;gap:16px;align-items:center}
    .nav-links a{color:#fff;font-weight:500}
    .btn{padding:8px 14px;border-radius:8px;cursor:pointer}
    .btn.blue{background:var(--accent);color:#fff;border:none}
    .btn.ghost{background:transparent;color:#fff;border:1px solid #fff}

    /* 主體區（白底黑字） */
    .wrap{max-width:1200px;margin:0 auto;padding:24px}
    .h1{font-size:28px;margin:0 0 10px}
    .muted{color:#555}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}
    .card{background:#fff;border:1px solid var(--border);border-radius:12px;overflow:hidden}
    .thumb{aspect-ratio:16/9;background:#000;position:relative}
    .thumb img{width:100%;height:100%;object-fit:cover;opacity:.9}
    .pill{position:absolute;bottom:10px;left:10px;background:#000;color:#fff;
          font-size:12px;border-radius:999px;padding:4px 10px}
    .pad{padding:14px}
    .meta{display:flex;justify-content:space-between;color:#555;font-size:12px}

    footer{border-top:1px solid #ccc;margin-top:24px;padding:16px 0;color:#666;font-size:14px}

    /* 登入模組 */
    #authModal {
      position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;
    }
    #authModal .box{
      background:#fff;color:#000;padding:24px 28px;border-radius:12px;width:320px;max-width:90%;
      box-shadow:0 4px 20px rgba(0,0,0,.3);
    }
    #authModal input{
      width:100%;padding:8px 10px;margin:6px 0;border:1px solid #ccc;border-radius:6px;
    }
    #authModal .actions{display:flex;gap:8px;margin-top:12px}
    #authModal .link{color:#3c7cff;cursor:pointer;font-size:14px}
    #userBadge{margin-left:8px;font-size:14px;color:#ccc}
  </style>
</head>
<body>
  <!-- 工具列 -->
  <header>
    <div class="brand">
      <img src="./images/bookwide-logo.png" alt="BookWide" style="height:28px"/>
      <span>BookWide</span><span style="font-size:12px;background:#444;padding:2px 6px;border-radius:8px;">Beta</span>
    </div>
    <div class="nav-links">
      <a href="#services">服務導覽</a>
      <a href="#pricing">方案價格</a>
      <button id="btnLogin" class="btn ghost">登入</button>
      <button id="btnLogout" class="btn ghost" style="display:none;">登出</button>
      <span id="userBadge"></span>
    </div>
  </header>

  <div class="wrap">
    <section>
      <h1 class="h1">看影片、做測驗、背單字 —— 一頁完成</h1>
      <div class="muted">BookWide 用 <b>故事・音樂・電影・新聞・專業主題</b> 帶你學英文。</div>
    </section>

    <!-- 影片卡 -->
    <section id="catalog" style="margin-top:20px">
      <div class="grid" id="cardGrid"></div>
    </section>

    <!-- 學習功能 -->
    <section id="services" style="margin-top:24px">
      <h2>學習功能</h2>
      <div class="grid">
        <div class="card"><div class="pad"><b>🧠 逐句播放</b><br>一鍵回放 / 下一句。</div></div>
        <div class="card"><div class="pad"><b>🌗 雙語字幕</b><br>英文在上、中文在下。</div></div>
        <div class="card"><div class="pad"><b>📝 分區測驗</b><br>Vocabulary / Grammar。</div></div>
        <div class="card"><div class="pad"><b>📚 單字卡</b><br>遮字填空、朗讀。</div></div>
      </div>
    </section>

    <footer>
      <div>© <span id="y"></span> BookWide. 由影片 x 語言教育打造。</div>
    </footer>
  </div>

  <!-- 登入對話框 -->
  <div id="authModal">
    <div class="box">
      <h3>會員登入</h3>
      <input id="email" type="email" placeholder="Email">
      <input id="password" type="password" placeholder="密碼">
      <div class="actions">
        <button id="btnDoLogin" class="btn blue" style="flex:1;">登入</button>
        <button id="btnRegister" class="btn" style="flex:1;">註冊</button>
      </div>
      <div style="margin-top:10px;text-align:right">
        <span id="btnForgot" class="link">忘記密碼？</span>
      </div>
    </div>
  </div>

  <!-- Supabase SDK -->
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.48.1/+esm";

    const SUPABASE_URL = 'https://qtgwedankftrqjmzuset.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF0Z3dlZGFua2Z0cnFqbXp1c2V0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4NDYxMDMsImV4cCI6MjA3NDQyMjEwM30.jyETpt09pgm66aCZheMgsjtbKlVmYo-lt-hrrt6BF8g';
    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY, { auth: { persistSession: true }});

    const btnLogin  = document.getElementById('btnLogin');
    const btnLogout = document.getElementById('btnLogout');
    const userBadge = document.getElementById('userBadge');
    const modal = document.getElementById('authModal');

    const emailEl = document.getElementById('email');
    const passEl  = document.getElementById('password');
    const btnDoLogin = document.getElementById('btnDoLogin');
    const btnRegister = document.getElementById('btnRegister');
    const btnForgot = document.getElementById('btnForgot');

    // 顯示用戶
    function showUser(user){
      if(user){
        btnLogin.style.display='none';
        btnLogout.style.display='';
        userBadge.textContent = user.email || '';
      }else{
        btnLogin.style.display='';
        btnLogout.style.display='none';
        userBadge.textContent = '';
      }
    }

    // 初始化
    const { data: { session } } = await supabase.auth.getSession();
    showUser(session?.user || null);
    supabase.auth.onAuthStateChange((_e, s)=>showUser(s?.user || null));

    // 登入 / 登出
    btnLogin.onclick = ()=>modal.style.display='flex';
    btnLogout.onclick = async()=>{ await supabase.auth.signOut(); showUser(null); };

    // Email 登入
    btnDoLogin.onclick = async()=>{
      const { error } = await supabase.auth.signInWithPassword({
        email: emailEl.value.trim(),
        password: passEl.value.trim()
      });
      if(error) alert(error.message);
      else modal.style.display='none';
    };

    // 註冊
    btnRegister.onclick = async()=>{
      const { error } = await supabase.auth.signUp({
        email: emailEl.value.trim(),
        password: passEl.value.trim()
      });
      if(error) alert(error.message);
      else alert("註冊成功，請至信箱驗證後登入。");
    };

    // 忘記密碼
    btnForgot.onclick = async()=>{
      const email = emailEl.value.trim();
      if(!email){ alert("請先輸入 Email"); return; }
      const { error } = await supabase.auth.resetPasswordForEmail(email, {
        redirectTo: window.location.origin
      });
      if(error) alert(error.message);
      else alert("已寄出重設密碼郵件！");
    };

    // 點擊外部關閉
    modal.addEventListener('click', e=>{
      if(e.target===modal) modal.style.display='none';
    });

    // 範例教材
    const CATALOG = [
      { slug:'mid-autumn', title:'Mid-Autumn Festival', cat:'故事', mins:2, level:'A2-B1', thumb:'./videos/mid-autumn.jpg' },
      { slug:'houyi', title:'Hou Yi and the Ten Suns', cat:'故事', mins:3, level:'A2-B1', thumb:'./videos/houyi.jpg' },
      { slug:'lantern', title:'Lantern Festival', cat:'故事', mins:2, level:'A2', thumb:'./videos/lantern.jpg' },
    ];

    const grid=document.getElementById('cardGrid');
    grid.innerHTML = CATALOG.map(it=>`
      <a class="card" href="./player.html?slug=${it.slug}">
        <div class="thumb"><img src="${it.thumb}" alt="${it.title}"><div class="pill">${it.cat}</div></div>
        <div class="pad"><b>${it.title}</b><div class="meta"><span>${it.mins} 分</span><span>${it.level}</span></div></div>
      </a>
    `).join('');
    document.getElementById('y').textContent=new Date().getFullYear();
  </script>
</body>
</html>

















